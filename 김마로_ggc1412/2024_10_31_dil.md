**범위 : ch02, 36p ~ 51p**

서버 설정 기능을 만들면서 개발자들이 했던 고민들은 응용할 부분이 많은 것 같다.

설정 파일을 메모리에 가져와서 사용한다는 부분도 그렇고, mysqld-auto.cnf을 사용하는 것은 특히 인상깊다.

- 기존 설정 파일을 남겨 놓아 RESET 할 수 있도록 한 부분 → 안정성 확보
- 변경 사항을 함께 기록하는 부분 → 시스템 기동 시 설정을 따로 읽어서 메모리에 넣기 때문에 기타 내용들이 많은 것이 문제가 되지 않는다.

### 2.4 서버 설정

- MySQL 서버는 설정된 여러 개의 디렉터리를 순차적으로 탐색하면서 처음 발견된 my.cnf 파일을 사용한다.
- 서버는 설정 파일을 다음과 같은 순서로 찾으며 먼저 읽는 설정 파일이 우선 순위를 가진다.
    1. /etc/my.cnf
    2. /etc/mysql/my.cnf
    3. /usr/etc/my.cnf
    4. ~/.my.cnf
- 하나의 설정 파일에 여러 개의 설정 그룹을 담을 수 있으며, 대체로 실행 프로그램 이름을 그룹명으로 사용한다.
- 서버는 기동하면서 설정 파일의 내용을 읽어서 메모리나 작동 방식을 초기화하고, 이러한 값을 별도로 저장해 둔다.
    - 이렇게 저장한 값을 시스템 변수라고 한다.
    - SHOW VARIABLES 또는 SHOW GLOBAL VARIABLES 로 조회할 수 있다.
- 시스템 변수
    - 시스템 변수가 가지는 5가지 속성은 다음과 같다.
        - Cmd-Line : 서버의 명령행 인자로 설정될 수 있는지
        - Option file : 설정 파일인 my.cnf로 제어할 수 있는지
        - System Var : 시스템 변수인지 아닌지
        - Var Scope : 시스템 변수의 적용 범위. Global, Session, Both 가 있다.
            - 일반적으로 세션별로 적용되는 시스템 변수의 경우, 글로벌 변수와 세션 변수에 동시에 존재한다.
        - Dynamic : 시스템 변수가 동적 변수인지 정적 변수 인지
- 글로벌 변수
    - 서버 인스턴스에서 전체적으로 영향을 미치는 시스템 변수로 MySQL 서버 자체에 관련된 설정일 때가 많다.
- 세션 변수
    - 클라이언트가 서버에 접속할 때 기본으로 부여하는 옵션의 기본값을 제어하는 데 사용된다.
- 정적 변수와 동적 변수
    - 서버가 기동 중인 상태에서 변경 가능한 지에 따라 동적 변수와 정적 변수로 구분된다.
    - 시스템 변수의 변경은 디스크에 저장되어 있는 설정 파일을 변경하는 경우와 서버 메모리에 있는 시스템 변수를 변경하는 경우가 있다.
        - SET 명령을 통해 변경값이 설정 파일에 반영되지 않으므로, 서버를 재기동하면 기존 설정값으로 바뀐다.
        - SET PERSIST 명령을 통해 서버의 시스템 변수와 설정 파일을 동시에 변경할 수 있다.
            - 이때 별도의 설정 파일(mysqld-auto.cnf)에 변경 내용을 추가로 기록하고, 서버가 다시 시작할 때는 my.cnf 뿐 아니라 mysqld-auto.cnf 파일도 같이 참조하여 시스템 변수를 적용한다.
            - mysqld-auto.cnf 에는 시스템 변수의 이름과 설정값, 언제 누구에 의해 시스템 변수가 변경됐는지 등의 정보가 함께 기록된다.
            - RESET PERSIST 명령을 사용하여 mysqld-auto.cnf 파일의 내용을 삭제 할 수 있다.
            - 세션 변수에는 적용되지 않는다. → 설정 파일이 바뀌는 부분이니까 당연히
        - 설정 파일만 변경하려면 SET PERSIST ONLY 명령을 사용하면 된다.
            - 정적인 변수는 서버 기동 중 값을 바꿀 수 없기 때문에 역시 이 명령을사용한다.
        - GLOBAL 키워드를 사용하면 글로벌 시스템 변수의 목록과 내용을 읽고 변경할 수 있다. GLOBAL 키워드를 빼면 자동으로 세션 변수를 조회하고 변경한다.
    - 동적 변수는 서버 기동 중에도 SET 명령으로 시스템 변수를 변경할 수 있다.